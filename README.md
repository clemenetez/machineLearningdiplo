# EDSR Super Resolution - –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –ø–æ–∫—Ä–∞—â–µ–Ω—É –≤–µ—Ä—Å—ñ—é –º–æ–¥–µ–ª—ñ EDSR (Enhanced Deep Super Resolution) –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –∑–æ–±—Ä–∞–∂–µ–Ω—å. –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—è –ø–æ–ª—è–≥–∞—î –≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –ø–∞—Ç—á—ñ–≤ –∑–∞–º—ñ—Å—Ç—å —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –≤—Å—å–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### 1. –ü—ñ–¥—Ö—ñ–¥ –∑ –ø–∞—Ç—á–∞–º–∏
–ó–∞–º—ñ—Å—Ç—å —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É (—Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –≤—Å—å–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è ‚Üí –∑–±—ñ–ª—å—à–µ–Ω–Ω—è), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±—ñ–ª—å—à —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:
- **–í–∏—Ä—ñ–∑–∞–Ω–Ω—è –ø–∞—Ç—á—ñ–≤**: –ó –≤–µ–ª–∏–∫–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏—Ä—ñ–∑–∞—é—Ç—å—Å—è –º–∞–ª—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ (48x48 –ø—ñ–∫—Å–µ–ª—ñ–≤)
- **–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ç—á—ñ–≤**: –ö–æ–∂–µ–Ω –ø–∞—Ç—á –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ
- **–ó–±—ñ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É**: –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–∞—Ç—á—ñ –∑–±–∏—Ä–∞—é—Ç—å—Å—è –Ω–∞–∑–∞–¥ —É –ø–æ–≤–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

### 2. –†–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–µ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—ó
- –î–æ–¥–∞–≤–∞–Ω–Ω—è —à—É–º—É –¥–ª—è –±—ñ–ª—å—à–æ—ó —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ —ñ–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü—ñ—ó
- –ü–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è –ø–∞—Ç—á—ñ–≤ –¥–ª—è –ø–ª–∞–≤–Ω–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤

### 3. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
- –ó–±—ñ–ª—å—à–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å residual –±–ª–æ–∫—ñ–≤ (16 –∑–∞–º—ñ—Å—Ç—å 8)
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
- –î–æ–¥–∞–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ (PSNR)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ edsr.py              # –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ EDSR –º–æ–¥–µ–ª—ñ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py           # –î–∞—Ç–∞—Å–µ—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ø–∞—Ç—á–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ data_preparation.py  # –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ hr/                  # –í–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ lr/                  # –ù–∏–∑—å–∫–æ—è–∫—ñ—Å–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
‚îú‚îÄ‚îÄ results/                 # –ó–±–µ—Ä–µ–∂–µ–Ω—ñ –º–æ–¥–µ–ª—ñ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É
‚îú‚îÄ‚îÄ train.py                # –°–∫—Ä–∏–ø—Ç —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ predict.py              # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è
‚îî‚îÄ‚îÄ requirements.txt        # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```

## üõ†Ô∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. –ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
```bash
git clone <repository-url>
cd edsr-super-resolution
```

2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```bash
pip install -r requirements.txt
```

## üìä –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
python utils/data_preparation.py
```

### –†—É—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞
1. –ü–æ–º—ñ—Å—Ç—ñ—Ç—å –≤–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ –ø–∞–ø–∫—É `data/hr/`
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö

## üéØ –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ

```bash
python train.py
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è:**
- –†–æ–∑–º—ñ—Ä –ø–∞—Ç—á–∞: 48x48 –ø—ñ–∫—Å–µ–ª—ñ–≤
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ç—á—ñ–≤ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è: 8
- Batch size: 16
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ø–æ—Ö: 200
- Learning rate: 1e-4

**–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:**
- –ì—Ä–∞—Ñ—ñ–∫–∏ –≤—Ç—Ä–∞—Ç (train/validation)
- PSNR –º–µ—Ç—Ä–∏–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–æ—ó –º–æ–¥–µ–ª—ñ

## üîÆ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è

```bash
python predict.py
```

**–§—É–Ω–∫—Ü—ñ—ó:**
- –û–±—Ä–æ–±–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å –ø–æ –ø–∞—Ç—á–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤ –∑–æ–±—Ä–∞–∂–µ–Ω—å

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—ñ–¥—Ö–æ–¥—ñ–≤

| –ü—ñ–¥—Ö—ñ–¥ | –ü–µ—Ä–µ–≤–∞–≥–∏ | –ù–µ–¥–æ–ª—ñ–∫–∏ |
|--------|----------|----------|
| **–¢—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏–π** | –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó | –í—Ç—Ä–∞—Ç–∞ –¥–µ—Ç–∞–ª–µ–π |
| **–ü–∞—Ç—á-–±–∞–∑–æ–≤–∞–Ω–∏–π** | –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–µ—Ç–∞–ª–µ–π | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó |

### –ú–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ
- **PSNR**: –ü—ñ–∫–æ–≤–µ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è —Å–∏–≥–Ω–∞–ª-—à—É–º
- **–í—ñ–∑—É–∞–ª—å–Ω–∞ —è–∫—ñ—Å—Ç—å**: –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–æ–±–∫–∞

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ –≤ `config.py`:

```python
# –†–æ–∑–º—ñ—Ä –ø–∞—Ç—á–∞
PATCH_SIZE = 48

# –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ç—á—ñ–≤ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
NUM_PATCHES_PER_IMAGE = 8

# –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ
UPSCALE_FACTOR = 2
NUM_BLOCKS = 16
CHANNELS = 64
```

## üé® –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó
```python
from predict import upscale_image_patches
from models.edsr import EDSR

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
model = EDSR(upscale_factor=2, num_blocks=16, channels=64)
model.load_state_dict(torch.load("results/best_model.pth"))

# –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
enhanced = upscale_image_patches(model, "input.jpg", "output.jpg", device)
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
```python
from utils.data_preparation import create_test_patches

create_test_patches("input_images/", "test_patches/", patch_size=48)
```

## üö® –í—ñ–¥–æ–º—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

1. **–ü–∞–º'—è—Ç—å**: –í–µ–ª–∏–∫—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –±–∞–≥–∞—Ç–æ –ø–∞–º'—è—Ç—ñ
2. **–ß–∞—Å –æ–±—Ä–æ–±–∫–∏**: –û–±—Ä–æ–±–∫–∞ –ø–æ –ø–∞—Ç—á–∞—Ö –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–æ—é
3. **–Ø–∫—ñ—Å—Ç—å –ø–∞—Ç—á—ñ–≤**: –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —è–∫–æ—Å—Ç—ñ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö

## üîÆ –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –î–æ–¥–∞–≤–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä (ESPCN, SRCNN)
- [ ] –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤ –∑–æ–±—Ä–∞–∂–µ–Ω—å
- [ ] –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
- [ ] –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –æ–±—Ä–æ–±–∫–∏
- [ ] –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ SSIM —Ç–∞ LPIPS

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–æ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π.

## ü§ù –í–Ω–µ—Å–æ–∫

–í—ñ—Ç–∞—é—Ç—å—Å—è –≤–Ω–µ—Å–∫–∏! –ë—É–¥—å –ª–∞—Å–∫–∞, —Å—Ç–≤–æ—Ä—é–π—Ç–µ issues —Ç–∞ pull requests.

---

**–ü—Ä–∏–º—ñ—Ç–∫–∞**: –¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ super resolution, —è–∫–∏–π –±—ñ–ª—å—à —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–∞–ª—å–Ω–∏–º —Å—Ü–µ–Ω–∞—Ä—ñ—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑—Ä—ñ–∑–Ω–∏—Ç–∏ –¥–µ—Ç–∞–ª—ñ –Ω–∞ –ø–æ–≥–∞–Ω–æ—ó —è–∫–æ—Å—Ç—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö. 